<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sugestões DevBurger</title>
  <link rel="stylesheet" href="/css/style.css" />
</head>

<body>
  <section id="lista-lanches">
    <h2>Lanches disponíveis</h2>
    <ul id="lista"></ul>
  </section>
  <div class="container">
    <h1>Envie sua Sugestão</h1>
    <form id="suggestion-form" action="/sugestao" method="GET">
      <div class="form-group">
        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="nome" placeholder="Nome Completo" required />
      </div>

      <div class="form-group ingredients" id="ingredients-container">
        <label for="ingredientes">Ingredientes:</label>
        <input type="text" id="ingrediente-1" name="ingredientes" placeholder="Ingrediente 1" required />
      </div>

      <button type="button" id="add-ingredient">
        + Adicionar ingrediente
      </button>
      <hr style="margin: 1.5rem 0" />
      <div class="form-actions">
        <button type="submit">Enviar Sugestão</button>
        <a href="/contato" class="btn">Precisa de ajuda?</a>
      </div>
    </form>
  </div>

  <script>
    (function () {
      const container = document.getElementById("ingredients-container");
      const addBtn = document.getElementById("add-ingredient");

      addBtn.addEventListener("click", () => {
        const count = container.children.length + 1;

        const div = document.createElement("div");
        div.className = "ingredient-item";

        const input = document.createElement("input");
        input.type = "text";
        input.name = "ingredientes";
        input.placeholder = `Ingrediente ${count}`;
        input.required = true;

        const remove = document.createElement("button");
        remove.type = "button";
        remove.textContent = "Remover";
        remove.addEventListener("click", () => div.remove());

        div.appendChild(input);
        div.appendChild(remove);
        container.appendChild(div);
      });
    })();

    (function () {
      fetch("/api/lanches")
        .then((r) => (r.ok ? r.json() : Promise.reject(r.status)))
        .then((lanches) => {
          const ul = document.getElementById("lista");
          lanches.forEach(({ id, nome, ingredientes }) => {
            const li = document.createElement("li");
            li.innerHTML = `<strong>${id} — ${nome}</strong>: ${ingredientes.join(
              ", "
            )}`;
            ul.appendChild(li);
          });
        })
        .catch((err) => console.error("Erro ao buscar lanches:", err));
    })();
  </script>
</body>

</html>